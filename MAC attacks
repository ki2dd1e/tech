Манипулируя своим MAC адресом, злоумышленник способен на 2 атаки: переполнение таблицы коммутации (MAC flooding) и подмена MAC адреса (MAC spoofing). В обеих из них будем пользоваться утилитой macchanger.
Переполнение CAM таблицы коммутатора возможно, т.к. записи в данной таблицы ограничены (для коммутаторов Cisco Catalyst 3750G максимальное число записей равно 3200). При обычной работе коммутатор, получив фрейм и не зная MAC адрес получателя, отправляет ARP запрос, после чего, получив ответ, закрепляет за своим интерфейсом данный адрес. И здесь тонкий момент: коммутатор может как перезаписывать таблицу, обновляя соответствие нового MAC адреса отправителя и порта, с которого пришел фрейм, так и добавлять новые записи, не смотря на то, что порт один и тот же (последний случай обычно свойственнен старым моделям).
При добавлении новых записей атака проста - достаточно автоматизировать отправку большого числа фреймов, к примеру, с помощью yersinia (опция MAC flooding) или библиотеки scapy:
```
from scapy.all import *
import random
def mac_flood(interface, count):
    for _ in range(count):
        fake_mac = ":".join([f"{random.randint(0, 255):02x}" for _ in range(6)])
        sendp(Ether(src=fake_mac, dst="FF:FF:FF:FF:FF:FF")/IP(), iface=interface, verbose=0)
mac_flood("eth0", 100000)
```
Если же коммутатор обновляет запись с портом злоумышленника, то атаку придется модифицировать. Записи в таблице хранятся с определенным таймаутом (~300 секунд), по истечении которого таблица обновляется (с отправкой ARP запросов). Так, если фреймы с различными MAC адресами будут приходить быстрее, чем истечение времени обновления таблицы, будет возможно достичь флудинга. Пример скрипта на scapy:
```
from scapy.all import *
while True:
    sendp(Ether(src=RandMAC(), dst="FF:FF:FF:FF:FF:FF")/IP(), iface="eth0", verbose=0)
```
Сама по себе атака MAC flooding в чистом виде используется редко в силу повсеместной защиты современных коммутаторов, и более часто злоумышленники задействуют атаки типа ARP cache poisoning или DHCP spoofing.
Вторая атака - MAC spoofing - заключается в подмене MAC адреса злоумышленника на уже известный в сети адрес с целью сниффинга трафика. Атака элементарна и выполняется в одну команду утилитой macchanger:
```
macchanger -mac=xx:xx:xx:xx:xx:xx
```
Для защиты портов следует ограничить число подключений хостов, а также осуществить привязку MAC-адресов (в режиме обучения - первых нескольких MAC адресов) к данному порту:
```
int Ethernet 0/1
switchport mode access
switchport port-security
switchport port-security maximum 2
switchport port-security mac-address sticky
```
